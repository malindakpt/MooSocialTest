(function(a,b){"function"===typeof define&&define.amd?define("jquery mooPhrase mooUser mooEmoji hideshare bootstrap".split(" "),b):"object"===typeof exports?module.exports=b(require("jquery")):a.mooShare=b()})(this,function(a,b,k,l){var d=0;window.closeModal=function(){a("#shareFeedModal").modal("hide")};window.statusModal=function(g,c){a.fn.SimpleModal({btn_ok:b.__("btn_ok"),btn_cancel:b.__("btn_cancel"),model:"modal",title:g,contents:c}).showModal()};window.initShareBtn=function(){a("body").off("click",
".shareFeedBtn").on("click",".shareFeedBtn",function(){var b=a(this).attr("share-url");a.post(mooConfig.url.base+"/share/index",function(c){try{c=JSON.parse(c),c.nonLogin&&k.validateUser()}catch(f){a("#shareFeedModal iframe").attr("src",b),a("#shareFeedModal").modal({show:!0})}})})};a(document).keyup(function(a){if(27==a.keyCode&&1==d)return h()});var h=function(){if(1==d){var g=b.__("are_you_sure_leave_this_page");if(confirm(g))return d=0,a(window).unbind("beforeunload"),a("#themeModal").modal("hide"),
!0}else d=0,a("#themeModal").modal("hide")};return{init:function(){a(window).on("beforeunload",function(){if(1==d)return h()});window.initShareBtn();a("#shareFeedModal").on("hidden.bs.modal",function(b){document.getElementById("iframeShare").height="0px";a(b.target).removeData("bs.modal")})},initOnAjaxShare:function(g){a(".sharethis").hideshare({linkedin:!1,link:g.social_link_share});a("#myTabDrop1").click(function(){a("#myTabDrop1-contents").toggleClass("show_hide_dropdown")});var c=null;a('a[data-toggle="tab"]').on("shown.bs.tab",
function(b){a("#shareWarning").html("");c=b=a(b.target).attr("href");a("#share_type").val(b);switch(b){case "#friend":case "#msg":a("#friend").addClass("active in"),a("#msg").remove("active in")}a("#myTabDrop1").html(a(this).html());a("body").height();a("#page_share-ajax_share .userTagged").css("position","fixed")});a('a[data-toggle="tab"]').click(function(){a("#myTabDrop1-contents").removeClass("show_hide_dropdown")});a("#shareBtn").click(function(){a("#shareWarning").html("");switch(c){case "#friend":if(""==
a("#friendSuggestion").val()){a("#shareWarning").html("<span>"+b.__("please_select_friends_to_share")+"</span>");return}break;case "#msg":if(""==a("#friendSuggestion").val()){a("#shareWarning").html("<span>"+b.__("please_select_friends_to_share")+"</span>");return}break;case "#group":if(""==a("#groupSuggestion").val()){a("#shareWarning").html("<span>"+b.__("please_select_groups_to_share")+"</span>");return}break;case "#email":if(""==a('textarea[name="data[email]"]').val()){a("#shareWarning").html("<span>"+
b.__("please_input_emails_to_share")+"</span>");return}}a("#shareBtn").addClass("disabled");a.post(g.do_share_url,a("#activity_share_form").serialize(),function(d){d=a.parseJSON(d);window.parent.closeModal();window.parent.statusModal(b.__("status"),d.msg)})});var f="",e="",d="";a("#myTabDrop1-contents li a").on("click",function(){var b=a(this).attr("href"),c=a(this).parents("#content-wrapper");"#msg"==b||"#email"==b||"#socialshare"==b?(f=c.find("textarea#message"),e=c.find(".textoverlay-wrapper"),
d=c.find(".userTagged .user-tagging-container"),0<e.length?(e.hide(),e.find("input.messageHidden").attr("name","messageTextHidden")):(f.hide(),f.attr("name","messageTextHidden")),c.find("#messageHidden").attr({name:"data[message]"}),c.find("#messageHidden").val(""),c.find("#messageHidden").show(),d.hide()):"object"===typeof f&&("object"===typeof e&&(c.find("#messageHidden").attr("name","messageTextHidden").hide(),0<e.length?(e.find("input.messageHidden").attr("name","data[message]"),e.find("input.messageHidden").val(""),
e.find("div.textoverlay").html(""),e.show()):(f.attr("name","data[message]"),f.show()),f.val("")),"object"===typeof d&&d.show(),f=e=d="")})}}});
