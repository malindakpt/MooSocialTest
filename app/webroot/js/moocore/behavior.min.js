(function(a,e){"function"===typeof define&&define.amd?define("jquery mooButton mooOverlay mooResponsive mooAjax mooAlert spinner".split(" "),e):"object"===typeof exports?module.exports=e(require("jquery"),require("button")):a.mooBehavior=e()})(this,function(a,e,k,l,m,p){var f=!0,g=function(){a(".view-more .viewMoreBtn").unbind("click");a(".view-more .viewMoreBtn").click(function(){var b=a(this).data();q(b.url,b.div,this)});a(".view-more-chrono .viewMoreBtn").unbind("click");a(".view-more-chrono .viewMoreBtn").click(function(){var b=
a(this).data();r(b.url,b.div,this)})},n=function(){a(".view-more .viewMoreBtn").unbind("click");a(".view-more .viewMoreBtn").click(function(){var b=a(this).data();t(b.url,b.div,this)})},t=function(b,c,d){a(d).spin("small");a(d).parent().css("display","none");a.post(mooConfig.url.base+b,"",function(b){a(d).spin(!1);a("#"+c).find(".view-more:first").remove();a("#"+c).children(".clear:first").remove();a("#"+c).find(".loading:first").remove();a("#"+c).append(b);n()})},q=function(b,c,d){a(d).spin("small");
a(d).parent().css("display","none");"undefined"===typeof window.searchParams&&(window.searchParams="");a.post(mooConfig.url.base+b,window.searchParams,function(b){a(d).spin(!1);a("#"+c).find(".view-more:first").remove();a("#"+c).children(".clear:first").remove();a("#"+c).find(".loading:first").remove();f=!0;"comments"==c||"theaterComments"==c?(a("#"+c).append(b),a("#"+c+" .view-more").insertAfter("#"+c+' li[id^="itemcomment_"]:last')):a("#"+c).append(b);k.registerOverlay();h();a(".tip").tipsy({html:!0,
gravity:"s"});window.initShareBtn();l.initFeedImage();g()})},r=function(b,c,d){a(d).spin("small");a(d).parent().css("display","none");"undefined"===typeof window.searchParams&&(window.searchParams="");a.post(mooConfig.url.base+b,window.searchParams,function(b){a(d).spin(!1);a("#"+c).find(".view-more:first").remove();a("#"+c).children(".clear:first").remove();a("#"+c).find(".loading:first").remove();f=!0;"comments"==c||"theaterComments"==c?(a("#"+c).prepend(b),a("#"+c+" .view-more").insertAfter("#"+
c+' li[id^="itemcomment_"]:last')):a("#"+c).prepend(b);k.registerOverlay();h();a(".tip").tipsy({html:!0,gravity:"s"});window.initShareBtn();l.initFeedImage();g()})},h=function(){a(".comment_thumb a").length&&a(".comment_thumb a").magnificPopup({type:"image",gallery:{enabled:!1},zoom:{enabled:!0,opener:function(a){return a}}})};return{initAutoLoadMore:function(){""!=mooConfig.autoLoadMore&&a(window).scroll(function(){var b=a(".view-more");if(0<b.length){var c=a(window),d=c.scrollTop(),c=d+c.height(),
e=b.offset().top;e+b.height()<=c&&e>=d&&f&&(b.before('<div style="text-align: center" class="loading"><img src="'+mooConfig.url.base+'/img/loading.gif" /></div>'),b.find("a").trigger("click"),f=!1)}})},createItem:function(b,c){e.disableButton("saveBtn");var d="ajax_save";c&&(d="save");m.post({url:mooConfig.url.base+"/"+b+"/"+d,data:a("#createForm").serialize()},function(c){c=a.parseJSON(c);1==c.result?window.location=mooConfig.url.base+"/"+b+"/view/"+c.id:(e.enableButton("saveBtn"),a(".error-message").show(),
a(".error-message").html(c.message),0<a(".spinner").length&&a(".spinner").remove())})},initMoreResults:g,initMoreResultsPopup:n,toggleCheckboxes:function(b){b.checked?a(".check").attr("checked","checked"):a(".check").attr("checked",!1)},toggleMenu:function(b){"leftnav"==b?"-200px"==a("#leftnav").css("left")?(a("#leftnav").animate({left:0},300),a("#right").animate({right:-204},300),a("#center").animate({left:200},300)):(a("#leftnav").animate({left:-200},300),a("#center").animate({left:0},300)):"-204px"==
a("#right").css("right")?(a("#right").show(),a("#right").animate({right:0},300),a("#leftnav").animate({left:-200},300),a("#center").animate({left:0},300)):a("#right").animate({right:-204},300,function(){a("#right").hide()})},registerImageComment:h,initOnReportItem:function(){a("#reportButton").unbind("click");a("#reportButton").click(function(){e.disableButton("reportButton");a("#reportButton").spin("small");m.post({url:mooConfig.url.base+"/reports/ajax_save",data:a("#reportForm").serialize()},function(b){e.enableButton("reportButton");
a("#reportButton").spin(!1);b=a.parseJSON(b);1==b.result?(a(".error-message").hide(),p.alert(b.message),a("#portlet-config").modal("hide"),a("#themeModal").modal("hide")):(a(".error-message").show(),a(".error-message").html(b.message))})});return!1}}});